<div class="users">
  <div class="backdrop" [ngStyle]="{'display': showBackdrop}">
    <div class="custom-modal" [ngStyle]="{'display': showPopup}">
      <app-add-user (changeShowPopupOutput)="changeShowPopup()"></app-add-user>
    </div>
  </div>
  <div class="head">
    <div class="title">
      Users
    </div>
  </div>
  <div class="misc-data">
    <div class="data">
      <div class="value">65</div>
      <div class="label">Projects</div>
    </div>
    <div class="data">
      <div class="value">12</div>
      <div class="label">Assigned BAs</div>
    </div>
    <div class="data">
      <div class="value">82</div>
      <div class="label">Total tasks</div>
    </div>
    <div class="actions">
      <div class="btn primary" (click)="changeShowPopup()">
        +Add User
      </div>
    </div>
  </div>
  <div class="users-list">
    <table mat-table [dataSource]="dataSource" matSort style="width: 100%; border-collapse: separate;">

      <ng-container matColumnDef="username">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="table_alignZ pl-0" style="z-index: 10 !important;">
          Username
        </th>
        <td mat-cell *matCellDef="let element; let i = index" class="pl-2"> <input name="username"
            [value]="element.username" [disabled]="isEditIndex !== i" autocomplete="off"></td>
      </ng-container>

      <ng-container matColumnDef="email">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="table_alignZ">Email</th>
        <td mat-cell *matCellDef="let element; let i = index">
          <input name="email" [value]="element.email ?? ''" [disabled]="isEditIndex !== i" autocomplete="off">
        </td>

      </ng-container>

      <ng-container matColumnDef="role">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="table_alignZ">Role</th>
        <td mat-cell *matCellDef="let element; let i = index">
          <input name="role" [value]="element.role ?? ''" [disabled]="isEditIndex !== i" autocomplete="off">
        </td>
      </ng-container>

      <ng-container matColumnDef="password">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="table_alignZ">Password</th>
        <td mat-cell *matCellDef="let element; let i = index">
          <input name="password" [type]="element.hide ? 'text' : 'password'" [value]="element.password ?? ''"
            [disabled]="isEditIndex !== i" autocomplete="off">
          <span><mat-icon matSuffix (click)="element.hide = !element.hide" *ngIf="isEditIndex === i">{{element.hide ?
              'visibility' :
              'visibility_off'}}</mat-icon></span>
        </td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="table_alignZ">Actions</th>
        <td mat-cell *matCellDef="let element; let i = index">
          <mat-icon (click)="changeEditMode(i)" *ngIf="isEditIndex !== i" tabindex="1">edit</mat-icon>
          <mat-icon (click)="changeEditMode(-1)" *ngIf="isEditIndex === i">save</mat-icon>
          <mat-icon>delete_forever</mat-icon>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns;sticky:true"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns; let i = index">
      </tr>
    </table>
  </div>
</div>
